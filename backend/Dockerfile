# ============================================
# üêç IMAGEM BASE
# ============================================
# Imagem oficial do Python 3.11, vers√£o slim (mais leve)
FROM python:3.11-slim

# ============================================
# üìÅ DIRET√ìRIO DE TRABALHO
# ============================================
WORKDIR /app

# ============================================
# ‚öôÔ∏è CONFIGURA√á√ïES DE AMBIENTE
# ============================================
# N√£o gerar arquivos .pyc
ENV PYTHONDONTWRITEBYTECODE=1
# Sa√≠da sem buffer (logs em tempo real)
ENV PYTHONUNBUFFERED=1

# ============================================
# üì¶ DEPEND√äNCIAS DO PROJETO
# ============================================
# Copia apenas o requirements para cache eficiente
COPY requirements.txt /app/

# Instala as depend√™ncias do backend
RUN pip install --no-cache-dir -r requirements.txt

# ============================================
# üì¶ C√ìDIGO DA APLICA√á√ÉO
# ============================================
# Copia todo o conte√∫do do backend para dentro do container
COPY . /app

# ============================================
# üîå PORTA EXPOSTA
# ============================================
EXPOSE 8000

# ============================================
# üöÄ COMANDO DE INICIALIZA√á√ÉO
# ============================================
# Aplica migra√ß√µes e inicia o servidor de desenvolvimento do Django
CMD ["sh", "-c", "python manage.py migrate && python manage.py runserver 0.0.0.0:8000"]
