version: "3.9"

# ============================================
# üê≥ BLUEWAVE NEURAL CHAT - DOCKER COMPOSE
# Backend (Django + DRF) + Frontend (React + Vite)
# ============================================

services:
  # ------------------------------------------
  # üß† BACKEND - DJANGO + DRF
  # ------------------------------------------
  backend:
    build: ./backend              # Dockerfile localizado em ./backend
    container_name: bluewave-backend
    # Comando: aplica migra√ß√µes e inicia o servidor Django
    command: sh -c "python manage.py migrate && python manage.py runserver 0.0.0.0:8000"
    volumes:
      - ./backend:/app            # Monta o c√≥digo local dentro do container (hot reload em dev)
    ports:
      - "8000:8000"               # Host:Container (API acess√≠vel em http://localhost:8000)
    # environment:
    #   - DJANGO_SETTINGS_MODULE=bluewave_backend.settings
    #   - DEBUG=1

  # ------------------------------------------
  # üé® FRONTEND - REACT + VITE
  # ------------------------------------------
  frontend:
    build: ./frontend             # Dockerfile localizado em ./frontend
    container_name: bluewave-frontend
    volumes:
      - ./frontend:/app           # C√≥digo local montado para desenvolvimento
      - /app/node_modules         # Volume an√¥nimo para node_modules dentro do container
    ports:
      - "5173:5173"               # Host:Container (SPA em http://localhost:5173)
    depends_on:
      - backend                   # Garante que o backend suba antes do frontend
    # environment:
    #   - VITE_API_BASE_URL=http://localhost:8000/api

# ============================================
# üîó REDE (opcional: deixar o padr√£o do Docker)
# ============================================
# networks:
#   default:
#     name: bluewave-network
#     driver: bridge
